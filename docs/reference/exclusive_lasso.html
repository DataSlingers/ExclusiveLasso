<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a GLM with Exclusive Lasso Regularization — exclusive_lasso • ExclusiveLasso</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit a GLM with Exclusive Lasso Regularization — exclusive_lasso" />
<meta property="og:description" content="Fit a generalized linear model via maximum penalized likelihood
using the exclusive lasso penalty. The regularization path is computed
along a grid of values for the regularization parameter (lambda).
The interface is intentionally similar to that of glmnet in
the package of the same name." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ExclusiveLasso</a>
        <span class="version label label-info" data-toggle="tooltip" data-placement="bottom" title="ExclusiveLasso is not yet on CRAN">0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ExclusiveLasso.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DataSlingers/ExclusiveLasso">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a GLM with Exclusive Lasso Regularization</h1>
    <small class="dont-index">Source: <a href='https://github.com/DataSlingers/ExclusiveLasso/blob/master/R/ExclusiveLasso.R'><code>R/ExclusiveLasso.R</code></a></small>
    <div class="hidden name"><code>exclusive_lasso.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit a generalized linear model via maximum penalized likelihood
using the exclusive lasso penalty. The regularization path is computed
along a grid of values for the regularization parameter (lambda).
The interface is intentionally similar to that of <code><a href='https://rdrr.io/pkg/glmnet/man/glmnet.html'>glmnet</a></code> in
the package of the same name.</p>
    </div>

    <pre class="usage"><span class='fu'>exclusive_lasso</span>(
  <span class='no'>X</span>,
  <span class='no'>y</span>,
  <span class='no'>groups</span>,
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"gaussian"</span>, <span class='st'>"binomial"</span>, <span class='st'>"poisson"</span>),
  <span class='no'>weights</span>,
  <span class='no'>offset</span>,
  <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>lambda.min.ratio</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>nobs</span> <span class='kw'>&lt;</span> <span class='no'>nvars</span>, <span class='fl'>0.01</span>, <span class='fl'>1e-04</span>),
  <span class='no'>lambda</span>,
  <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>lower.limits</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(-<span class='fl'>Inf</span>, <span class='no'>nvars</span>),
  <span class='kw'>upper.limits</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>Inf</span>, <span class='no'>nvars</span>),
  <span class='kw'>thresh</span> <span class='kw'>=</span> <span class='fl'>1e-07</span>,
  <span class='kw'>thresh_prox</span> <span class='kw'>=</span> <span class='no'>thresh</span>,
  <span class='kw'>skip_df</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"cd"</span>, <span class='st'>"pg"</span>)
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>The matrix of predictors (\(X \in \R^{n \times p}\))</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>The response vector (\(y\))</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>An integer vector of length \(p\) indicating group membership.
(Cf. the <code>group</code> argument of <code><a href='https://rdrr.io/pkg/grpreg/man/grpreg.html'>grpreg</a></code>)</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>The GLM response type. (Cf. the <code>family</code> argument of
<code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code>)</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Weights applied to individual
observations. If not supplied, all observations will be equally
weighted. Will be re-scaled to sum to \(n\) if
necessary. (Cf. the <code>weight</code> argument of
<code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code>)</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>A vector of length \(n\) included in the linear
predictor.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>The number of lambda values to use in computing the
regularization path. Note that the time to run is typically sublinear
in the grid size due to the use of warm starts.</p></td>
    </tr>
    <tr>
      <th>lambda.min.ratio</th>
      <td><p>The smallest value of lambda to be used, as a fraction
of the largest value of lambda used. Unlike the lasso, there is no
value of lambda such that the solution is wholly sparse, but we still
use lambda_max from the lasso.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A user-specified sequence of lambdas to use.</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>Should <code>X</code> be centered and scaled before fitting?</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>Should the fitted model have an (unpenalized) intercept term?</p></td>
    </tr>
    <tr>
      <th>lower.limits</th>
      <td><p>A vector of lower bounds for each coefficient (default <code>-Inf</code>).
Can either be a scalar (applied to each coefficient) or a vector
of length <code>p</code> (number of coefficients).</p></td>
    </tr>
    <tr>
      <th>upper.limits</th>
      <td><p>A vector of lower bounds for each coefficient (default <code>Inf</code>).
Can either be a scalar (applied to each coefficient) or a vector
of length <code>p</code> (number of coefficients).</p></td>
    </tr>
    <tr>
      <th>thresh</th>
      <td><p>The convergence threshold used for the proximal
gradient or coordinate-descent algorithm used to solve the
penalized regression problem.</p></td>
    </tr>
    <tr>
      <th>thresh_prox</th>
      <td><p>The convergence threshold used for the
coordinate-descent algorithm used to evaluate the proximal operator.</p></td>
    </tr>
    <tr>
      <th>skip_df</th>
      <td><p>Should the DF calculations be skipped? They are often slower
than the actual model fitting; if calling <code>exclusive_lasso</code> repeatedly
it may be useful to skip these calculations.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>Which algorithm to use, proximal gradient (<code>"pg"</code>) or
coordinate descent (<code>"cd"</code>)? Empirically, coordinate descent appears
to be faster for most problems (consistent with Campbell and Allen), but
proximal gradient may be faster for certain problems with many small groups
where the proximal operator may be evaluated quickly and to high precision.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>ExclusiveLassoFit</code> containing</p><ul>
<li><p><code>coef</code> - A matrix of estimated coefficients</p></li>
<li><p><code>intercept</code> - A vector of estimated intercepts if <code>intercept=TRUE</code></p></li>
<li><p><code>X, y, groups, weights, offset</code> - The data used to fit the model</p></li>
<li><p><code>lambda</code> - The vector of \(\lambda\) used</p></li>
<li><p><code>df</code> - An unbiased estimate of the degrees of freedom (see Theorem
      5 in [1])</p></li>
<li><p><code>nnz</code> - The number of non-zero coefficients at each value of
      \(\lambda\)</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that unlike Campbell and Allen (2017), we use the "1/n"-scaling of the
loss function.</p>
<p>For the Gaussian case:
$$\frac{1}{2n}|y - X\beta|_2^2 + \lambda P(\beta, G)$$</p>
<p>For other GLMs:
$$-\frac{1}{n}\ell(y, X\beta)+ \lambda P(\beta, G)$$</p>
<p>By default, an optimized implementation is used for <code>family="gaussian"</code>
         which is approximately 2x faster for most problems. If you wish
         to disable this code path and use the standard GLM implementation
         with Gaussian response, set <code>options(ExclusiveLasso.gaussian_fast_path=FALSE).</code></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Campbell, Frederick and Genevera I. Allen. "Within Group Variable Selection
    with the Exclusive Lasso". Electronic Journal of Statistics 11(2),
    pp.4220-4257. 2017. doi: <a href='https://doi.org/10.1214/17-EJS1317'>10.1214/17-EJS1317</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span>
<span class='no'>groups</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>times</span><span class='kw'>=</span><span class='fl'>50</span>)
<span class='no'>beta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(<span class='no'>p</span>);
<span class='no'>beta</span>[<span class='fl'>1</span>:<span class='fl'>10</span>] <span class='kw'>&lt;-</span> <span class='fl'>3</span>

<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span> * <span class='no'>p</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>p</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span> + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>)

<span class='no'>exfit</span> <span class='kw'>&lt;-</span> <span class='fu'>exclusive_lasso</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>groups</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael Weylandt, Frederick Campbell, Genevera Allen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


